def reserve_book(request, book_id):
    user_id = request.session.get('user_id')
    user = get_object_or_404(User, user_id=user_id)
    book = get_object_or_404(Book, book_id=book_id)

    # Create a reservation
    reservation = Reservation.objects.create(
        user=user,
        book=book,
        reservation_date=datetime.now(),
        expiration_date=datetime.now() + timedelta(days=7)
    )

    return redirect(reverse('user_dashboard'))


=====================CORRECT ONEEEEE IS THE BELOW ONE===============
def reserve_book(request, book_id):
    user_id = request.session.get('user_id')
    user = get_object_or_404(User, user_id=user_id)
    
    if request.method == 'POST':
        book = get_object_or_404(Book, book_id=book_id)
        
        # Check if the book is already reserved
        if Reservation.objects.filter(book=book, expiration_date__isnull=True).exists():
            return redirect('book_list')  # Optionally show a message "Already Reserved"
        
        reservation = Reservation(book=book, user=user)
        reservation.save()
        return render(request, 'user_dashboard.html', {'book': book})
    
    return redirect('book_list')